openapi: "3.0.1"
info:
  title: "aics-api"
  description: "AI-Customer-Service - Core API"
  version: "2024-09-05T01:54:32Z"
servers:
- url: "https://{hostUrl}.amazonaws.com/{basePath}"
  variables:
    basePath:
      default: "prod"
paths:
# Chat

# Chatbot
  /chatbot-management/embeddings:
    get:
      responses:
        "400":
          description: "400 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "500":
          description: "500 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "200":
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
      security:
      - aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0: []
  /chatbot-management/chatbots/{proxy+}:
    get:
      parameters:
      - name: "proxy"
        in: "path"
        required: true
        schema:
          type: "string"
      responses:
        "400":
          description: "400 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "500":
          description: "500 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "200":
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
      security:
      - aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0: []
  /chatbot-management/chatbots:
    get:
      responses:
        "400":
          description: "400 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "500":
          description: "500 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "200":
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
      security:
      - aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0: []
    post:
      responses:
        "400":
          description: "400 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "500":
          description: "500 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "200":
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
      security:
      - aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0: []
  /chatbot-management/check-chatbot:
    post:
      responses:
        "400":
          description: "400 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "500":
          description: "500 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "200":
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
      security:
      - aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0: []    

# Intention
  /intention/executions:
    get:
      responses:
        "400":
          description: "400 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "500":
          description: "500 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "200":
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
      security:
      - aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0: []
    post:
      responses:
        "400":
          description: "400 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "500":
          description: "500 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "200":
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
      security:
      - aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0: []
  /intention/executions/{executionId}:
    get:
      parameters:
      - name: "intentionId"
        in: "path"
        required: true
        schema:
          type: "string"
      - name: "executionId"
        in: "path"
        required: true
        schema:
          type: "string"
      responses:
        "400":
          description: "400 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "500":
          description: "500 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "200":
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/aicsaiapicohmy8hNMRxNWN"
      security:
      - aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0: []
  /intention/execution-presigned-url:
    post:
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/aicsaiapicoS7193iOfsONP"
        required: true
      responses:
        "400":
          description: "400 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "500":
          description: "500 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "200":
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/aicsaiapicoFa1ujqwjnv8W"
      security:
      - aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0: []
  /intention/download-template:
    get:
      responses:
        "400":
          description: "400 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "500":
          description: "500 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "200":
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
      security:
      - aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0: []
  /intention/index-used-scan:
    post:
      responses:
        "400":
          description: "400 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "500":
          description: "500 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "200":
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
      security:
      - aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0: []

# Prompt  
  /prompt-management/prompts:
    get:
      summary: List prompts
      description: |
        GET /prompt-management/prompts - This endpoint retrieves a list of prompts. The results can be paginated using the 'max_items' and 'page_size' query parameters.
      parameters:
        - name: max_items
          in: query
          schema:
            type: integer
          description: Maximum number of items to return
        - name: page_size
          in: query
          schema:
            type: integer
          description: Number of items per page
      responses:
        "400":
          description: "400 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "500":
          description: "500 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "200":
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
      security:
      - aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0: []
    post:
      summary: Create prompts
      description: |
        POST /prompt-management/prompts - This endpoint creates RAG/conversation summary/tool calling prompts for a chatbot.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreatePromptRequest"
            example:
              ChatbotId: demo
              GroupName: Admin
              ModelId: anthropic.claude-3-haiku-20240307-v1:0
              Prompt:
                conversation_summary:
                  few_shots: |
                    [\n  {\n    \"conversation\": [\n      {\n        \"role\": \"human\",\n        \"content\": \"Hello, I would like to know what to do if I do not agree with any decision.\"\n      },\n      {\n        \"role\": \"ai\",\n        \"content\": \"disagree with our decision about your monthly income adjustment amounts?\"\n      },\n      {\n        \"role\": \"human\",\n        \"content\": \"no. Where can I find my SHIP contact information?\"\n      },\n      {\n        \"role\": \"ai\",\n        \"content\": \"You can find your local SHIP contact information in the back of your Medicare & You 2020 Handbook online.\"\n      },\n      {\n        \"role\": \"human\",\n        \"content\": \"and how do they calculate the adjustments?\"\n      }\n    ],\n    \"rewrite_query\": \"How is the calculation for adjustments made by SHIP determined?\"\n  },\n  {\n    \"conversation\": [\n      {\n        \"role\": \"human\",\n        \"content\": \"I need to know how to prepare for college.\"\n      },\n      {\n        \"role\": \"ai\",\n        \"content\": \"You should first define your goals and interest and be sure to know the costs and how to plan financially and academically for college.\"\n      },\n      {\n        \"role\": \"human\",\n        \"content\": \"Is there something I can use as a guide to get ready for it?\"\n      }\n    ],\n    \"rewrite_query\": \"What resources or guides can I use to help me prepare for college?\"\n  },\n  {\n    \"conversation\": [\n      {\n        \"role\": \"human\",\n        \"content\": \"垃圾\"\n      }\n    ],\n    \"rewrite_query\": \"垃圾\"\n  },\n  {\n    \"conversation\": [\n      {\n        \"role\": \"human\",\n        \"content\": \"你好\"\n      }\n    ],\n    \"rewrite_query\": \"你好\"\n  }\n]
                  system_prompt: You are a helpful, pattern-following assistant.
                  user_prompt: "Given the following conversation between PersonU and PersonA:\n{conversation}\nInstead of having this entire conversation, how can PersonU get what he or she is\nlooking for using a single sentence? Keep the recent sentence of PersonU: “{current_query}” to be same if it is already self-explanatory. Don't make any explanations."
                rag:
                  system_prompt: You are a customer service agent, and answering user's query. You ALWAYS follow these guidelines when writing your response:\n<guidelines>\n- NERVER say \"根据搜索结果/大家好/谢谢/根据这个文档...\".\n- 回答简单明了\n- 如果问题与<docs>里面的内容不相关，请回答 \"根据内部知识库，找不到相关内容\"，不需要额外补充内容\n</guidelines>\n\nHere are some documents for you to reference for your query.\n<docs>\n{context}\n</docs>
                tool_calling:
                  user_prompt: "你是一个AI助理。今天是{date},{weekday}."
                  guidelines_prompt: |
                    "<guidlines>\n- Don't forget to output <function_calls> </function_calls> when any tool is called.\n- 每次回答总是先进行思考，并将思考过程写在<thinking>标签中。请你按照下面的步骤进行思考:\n    1. 判断根据当前的上下文是否足够回答用户的问题。\n    2. 如果当前的上下文足够回答用户的问题，请调用 `give_final_response` 工具。\n    3. 如果当前的上下文不能支持回答用户的问题，你可以考虑调用<tools> 标签中列举的工具。\n    4. 如果调用工具对应的参数不够，请调用反问工具 `give_rhetorical_question` 来让用户提供更加充分的信息。\n    5. 最后给出你要调用的工具名称。\n- Always output with the same language as the content within <query></query>. If the content is english, use englisth to output. If the content is chinese, use chinese to output.\n</guidlines>\n"
              Scene: common
              SortKey: anthropic.claude-3-haiku-20240307-v1:0__common__titanv2
      responses:
        "400":
          description: "400 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "500":
          description: "500 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "200":
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
      security:
      - aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0: []

  /prompt-management/scenes:
    get:
      responses:
        "400":
          description: "400 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "500":
          description: "500 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "200":
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
      security:
      - aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0: []
  /prompt-management/models:
    get:
      responses:
        "400":
          description: "400 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "500":
          description: "500 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "200":
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
      security:
      - aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0: []
  /prompt-management/prompts/{proxy+}:
    get:
      parameters:
      - name: "proxy"
        in: "path"
        required: true
        schema:
          type: "string"
      responses:
        "400":
          description: "400 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "500":
          description: "500 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "200":
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
      security:
      - aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0: []
    delete:
      parameters:
      - name: "proxy"
        in: "path"
        required: true
        schema:
          type: "string"
      responses:
        "400":
          description: "400 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "500":
          description: "500 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "200":
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
      security:
      - aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0: []

# Chat history
  /chat-history:
    post:
      responses:
        "400":
          description: "400 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "500":
          description: "500 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "200":
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
      security:
      - aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0: []
  /chat-history/sessions:
    get:
      summary: List chat sessions
      description: |
        GET /chat-history/sessions - This endpoint retrieves a list of chat sessions. The results can be paginated using the 'max_items' and 'page_size' query parameters.
      parameters:
        - name: max_items
          in: query
          schema:
            type: integer
          description: Maximum number of items to return
        - name: page_size
          in: query
          schema:
            type: integer
          description: Number of items per page
      responses:
        "400":
          description: "400 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "500":
          description: "500 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "200":
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
      security:
      - aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0: []
  /chat-history/messages:
    get:
      summary: List chat messages
      description: |
        GET /chat-history/messages - This endpoint retrieves a list of chat messages in a chat session. The results can be paginated using the 'max_items' and 'page_size' query parameters.
      parameters:
        - name: session_id
          in: query
          schema:
            type: string
          description: Chat session id which contains chat messages, e.g. b8a34e07-48ad-417c-9ddc-f2801ebf6a47
        - name: max_items
          in: query
          schema:
            type: integer
          description: Maximum number of items to return
        - name: page_size
          in: query
          schema:
            type: integer
          description: Number of items per page
      responses:
        "400":
          description: "400 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "500":
          description: "500 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
        "200":
          description: "200 response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Empty"
      security:
      - aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0: []
components:
  schemas:
    aicsaiapicopvCPtvHlfMt6:
      title: "PostPayload"
      required:
      - "executionId"
      type: "object"
      properties:
        executionId:
          type: "array"
          items:
            type: "string"
    Empty:
      title: "Empty Schema"
      type: "object"
    aicsaiapicolKK6o7ptLSTP:
      title: "ResponsePayload"
      type: "object"
      properties:
        data:
          type: "array"
          items:
            type: "string"
        message:
          type: "string"
    aicsaiapicoFa1ujqwjnv8W:
      title: "ResponsePayload"
      type: "object"
      properties:
        data:
          type: "string"
        message:
          type: "string"
        s3Prefix:
          type: "string"
        s3Bucket:
          type: "string"
    aicsaiapicoS7193iOfsONP:
      title: "PostPayload"
      required:
      - "content_type"
      - "file_name"
      type: "object"
      properties:
        content_type:
          type: "string"
        file_name:
          type: "string"
    
    aicsaiapicoPUseVtfPvX5T:
      title: "PostPayload"
      required:
      - "content_type"
      - "file_name"
      type: "object"
      properties:
        content_type:
          type: "string"
        file_name:
          type: "string"
    aicsaiapicohmy8hNMRxNWN:
      title: "ResponsePayload"
      type: "object"
      properties:
        Items:
          type: "array"
          items:
            required:
            - "createTime"
            - "executionId"
            - "s3Bucket"
            - "s3Path"
            - "s3Prefix"
            - "status"
            type: "object"
            properties:
              executionId:
                type: "string"
              s3Path:
                type: "string"
              createTime:
                type: "string"
              s3Prefix:
                type: "string"
              s3Bucket:
                type: "string"
              status:
                type: "string"
        Count:
          type: "integer"
    aicsaiapicocohEaD85KKTd:
      title: "ResponsePayload"
      type: "object"
      properties:
        Config:
          type: "object"
          properties:
            PageSize:
              type: "integer"
            MaxItems:
              type: "integer"
        Items:
          type: "array"
          items:
            required:
            - "chatbotId"
            - "createTime"
            - "embeddingModelType"
            - "executionId"
            - "executionStatus"
            - "groupName"
            - "indexId"
            - "indexType"
            - "offline"
            - "operationType"
            - "qaEnhance"
            - "s3Bucket"
            - "s3Prefix"
            - "sfnExecutionId"
            - "uiStatus"
            type: "object"
            properties:
              executionStatus:
                type: "string"
              s3Prefix:
                type: "string"
              uiStatus:
                type: "string"
              s3Bucket:
                type: "string"
              qaEnhance:
                type: "string"
              sfnExecutionId:
                type: "string"
              embeddingModelType:
                type: "string"
              offline:
                type: "string"
              executionId:
                type: "string"
              groupName:
                type: "string"
              chatbotId:
                type: "string"
              indexType:
                type: "string"
              createTime:
                type: "string"
              indexId:
                type: "string"
              operationType:
                type: "string"
        Count:
          type: "integer"
    CreatePromptRequest:
      type: object
      required:
        - ChatbotId
        - GroupName
        - ModelId
        - Prompt
        - Scene
        - SortKey
      properties:
        ChatbotId:
          type: string
          description: The ID of the chatbot, e.g. admin
        GroupName:
          type: string
          description: The Cognito group name, e.g. Admin
        ModelId:
          type: string
          description: The LLM model ID, e.g. anthropic.claude-3-haiku-20240307-v1:0
        Prompt:
          type: object
          description: Prompt to add to the chatbot
          required:
            - rag
            - conversation_summary
            - tool_calling
          properties:
            conversation_summary:
              type: object
              properties:
                few_shots:
                  type: string
                system_prompt:
                  type: string
                user_prompt:
                  type: string
            rag:
              type: object
              properties:
                system_prompt:
                  type: string
            tool_calling:
              type: object
              properties:
                user_prompt:
                  type: string
                guidelines_prompt:
                  type: string
        Scene:
          type: string
          description: The scene, default is common
        SortKey:
          type: string
          description: A combination with chatbot id, model id and scene, e.g. anthropic.claude-3-haiku-20240307-v1:0__common__titanv2
  securitySchemes:
    aicsaicustomerserviceapiconstructApiAuthorizer94F43DD0:
      type: "apiKey"
      name: "Authorization"
      in: "header"
      x-amazon-apigateway-authtype: "custom"



